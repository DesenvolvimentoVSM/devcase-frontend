<div class="container">

  <div class="titulo center">
    Pontos
  </div>

  <div class="row">
    <div class="col-md-3">
      <button type="button" class="btn btn-success" style="margin-bottom: 5%" (click)="showDialogPontos()">
        <i class="fa fa-plus"></i> Nova Pontuação</button>
    </div>
    <div>
      <a class="btn btn-danger" style="margin-bottom: 5%" routerLink="/menu">
        <i class="fa fa-arrow-circle-left"></i> Voltar</a>
    </div>
  </div>

  <div class="row col-md-6" style="margin-bottom: 5%;">
    <p-table #table [value]="pontuacoes" [paginator]="true" [rows]="5" [responsive]="true" [globalFilterFields]="['pontos']"
      [rowsPerPageOptions]="['5','15','20','30']">
      <ng-template pTemplate="caption">
        <div style="text-align: left">
          <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
          <input type="text" pInputText size="25%" placeholder="Pesquisar por pontos..." (input)="table.filterGlobal($event.target.value, 'contains')"
            style="width:auto">
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th class="center">Valor Inicial</th>
          <th class="center">Valor Final</th>
          <th class="center">Pontos</th>
          <th class="center">Ações</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-pontuacao>
        <tr>
          <td class="center">{{pontuacao.valorInicio | currency:'BRL'}}</td>
          <td class="center">{{pontuacao.valorFinal | currency:'BRL'}}</td>
          <td class="center pontos">{{pontuacao.pontos}}</td>
          <td class="center">
            <button class="btn btn-warning" pTooltip="Editar" tooltipPosition="top" style="margin-right: 5%" (click)="dialogAtualizarPontuacao(pontuacao)">
              <i class="fa fa-pen"></i></button>
            <button class="btn btn-danger" pTooltip="Excluir" tooltipPosition="top" (click)="confirmarExclusao(pontuacao.id)">
              <i class="fa fa-trash"></i></button>
          </td>
        </tr>
      </ng-template>
    </p-table>

  </div>

  <!-- DIALOG PARA CADASTRO DE PONTUACAO -->
  <p-dialog [(visible)]="dialogPontos" header="Cadastro de Pontuação" [modal]="true" [responsive]="true" [closable]="false">

    <form #form="ngForm">
      <div>
        <div class="col">Valor Inicial</div>
        <input currencyMask pInputText [(ngModel)]="pontos.valorInicio" name="valorInicio"
          [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }" required>
      </div>
      <br>

      <div>
        <div class="col">Valor Final</div>
        <input currencyMask pInputText [(ngModel)]="pontos.valorFinal" name="valorFinal"
          [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }" required>
      </div>
      <br>

      <div>
        <div class="col">Pontos</div>
        <input type="number" pInputText [(ngModel)]="pontos.pontos" name="pontos" required>
      </div>
      <br>

      <br>
    </form>

      <p-footer>
        <button type="button" class="btn btn-success" style="margin-right: 7px" [disabled]="form.invalid" (click)="cadastrarPontos()">
          <i class="fa fa-check"></i> Salvar</button>
        <button type="button" class="btn btn-danger" (click)="closeDialogPontos()">
          <i class="fa fa-times"></i> Cancelar</button>
      </p-footer>
  </p-dialog>

  <!-- DIALOG PARA ALTERAR PONTUACAO -->
  <p-dialog [(visible)]="dialogAlterarPontuacao" header="Alterar Pontuação" [modal]="true" [responsive]="true" [closable]="false">

    <form #formAtualizar="ngForm">
        <div>
            <div class="col">Valor Inicial</div>
            <input currencyMask pInputText [(ngModel)]="pontuacaoAlterada.valorInicio" name="valorInicio"
              [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }" required>
          </div>
          <br>
    
          <div>
            <div class="col">Valor Final</div>
            <input currencyMask pInputText [(ngModel)]="pontuacaoAlterada.valorFinal" name="valorFinal"
              [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }" required>
          </div>
          <br>
    
          <div>
            <div class="col">Pontos</div>
            <input type="number" pInputText [(ngModel)]="pontuacaoAlterada.pontos" name="pontos" required>
          </div>
          <br>
      <br>
    </form>

      <p-footer>
        <button type="button" class="btn btn-success" style="margin-right: 7px" [disabled]="!formAtualizar.dirty"
          (click)="atualizarPontuacao(pontuacaoAlterada.id, pontuacaoAlterada)">
          <i class="fa fa-check"></i> Salvar</button>
        <button type="button" class="btn btn-danger" (click)="closeDialogAlterar()" (click)="formAtualizar.reset()">
          <i class="fa fa-times"></i> Cancelar</button>
      </p-footer>
  </p-dialog>

  <!--DIALOG DE CONFIRMAR EXCLUSAO-->
  <p-dialog [(visible)]="dialogConfirmarExclusao" header="Confirmar Exclusão" [modal]="true" [closable]="false"
    [responsive]="true">
    <br>
    <h4>Você deseja realmente excluir ?</h4>
    <br>
    <p-footer>
      <button type="button" style="margin-right: 15px" class="btn btn-success" (click)="excluirPontuacao()">
        <i class="fa fa-check-circle"></i> Sim</button>
      <button type="button" class="btn btn-danger" (click)="dialogConfirmarExclusao=false">
        <i class="fa fa-times-circle"></i> Não</button>
    </p-footer>
  </p-dialog>

</div>
